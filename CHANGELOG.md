# 更新日志

## [2.3.0] - 2025-07-19

### 新增功能 ✨

#### 1. Cookie数据存储系统
- **Cookie存储管理器**: 全新的CookieStorageManager类，优化浏览器数据存储
- **智能分片存储**: 大型数据自动分片存储到多个cookies中
- **存储容量优化**: 每个cookie限制3KB，确保兼容性和稳定性
- **数据持久化**: 30天有效期，提供长期数据保存能力

#### 2. 存储系统增强
- **智能存储适配器**: SmartStorageAdapter提供多种存储方案
- **存储诊断功能**: 自动检测浏览器存储能力和使用情况
- **混合存储策略**: localStorage + cookies + sessionStorage多重备份
- **存储迁移支持**: 从localStorage平滑迁移到cookies存储

#### 3. 用户体验改进
- **改进的JavaScript代码生成**: 更清晰的浏览器控制台操作代码
- **详细的存储状态显示**: 实时显示数据保存状态和容量信息
- **优化的错误处理**: 更友好的错误信息和操作指导
- **自动存储方法选择**: 根据数据大小智能选择最优存储方案

### 技术改进 🔧

#### 存储架构优化
- **模块化存储管理**: 解耦存储逻辑，便于维护和扩展
- **异步存储处理**: 非阻塞的数据保存和加载机制
- **错误恢复机制**: 存储失败时的自动重试和降级策略
- **跨浏览器兼容性**: 全面支持主流浏览器的存储特性

#### 代码质量提升
- **存储功能测试**: 完整的cookies存储功能测试套件
- **性能优化**: 优化大数据的序列化和存储效率
- **内存使用优化**: 减少存储操作的内存占用

### 修复问题 🐛
- **修复localStorage显示问题**: 解决保存状态显示为空的问题
- **修复JavaScript代码生成**: 确保生成的JS代码正确显示给用户
- **优化存储错误处理**: 改进数据加载失败时的用户提示

### 文档更新 📚
- **更新存储说明**: 将localStorage相关说明更新为cookies存储
- **添加存储最佳实践**: 详细的数据存储和管理指导
- **完善故障排除**: 新增cookies存储相关的问题解决方案

---

## [2.2.0] - 2025-07-15

### 新增功能 ✨

#### 1. 完整的发布管理系统
- **GitHub上传指南**: 详细的GitHub项目上传和发布流程指南
- **配置安全指南**: 完整的API密钥和敏感信息安全管理指南
- **发布前检查脚本**: 自动化的发布前质量检查工具
- **项目状态文档**: 详细的项目开发状态和进度跟踪

#### 2. 开发者工具增强
- **快速开始脚本**: 一键式项目设置和启动工具
- **发布准备清单**: 系统化的发布前准备工作清单
- **自动化检查**: Python语法、依赖、安全性等多维度检查

#### 3. 文档体系完善
- **发布说明文档**: 详细的版本发布说明和升级指南
- **安全最佳实践**: 全面的安全配置和管理指南
- **故障排除指南**: 常见问题的解决方案和调试方法

### 技术改进 🔧

#### 代码质量
- **发布前检查**: 自动检查Python语法、导入语句、版本一致性
- **安全扫描**: 自动检测敏感信息泄露和安全漏洞
- **文档验证**: 自动验证文档完整性和链接有效性

#### 项目管理
- **版本管理**: 统一的版本号管理和更新机制
- **Git工作流**: 标准化的Git提交和发布流程
- **依赖管理**: 改进的依赖库管理和版本控制

### 修复的问题 🐛

#### 1. 大纲生成优化
- **问题**: 大纲生成时页面卡住
- **修复**: 优化生成逻辑，提高响应速度
- **影响**: 改善用户体验，减少等待时间

#### 2. 文档同步问题
- **问题**: 版本信息不一致
- **修复**: 实现自动化版本检查和更新
- **影响**: 确保所有文档版本信息同步

### 安全性增强 🔒

#### 配置安全
- **敏感信息保护**: 完善的.gitignore配置，防止敏感信息泄露
- **API密钥管理**: 详细的API密钥获取、存储和轮换指南
- **安全检查清单**: 系统化的安全检查和验证流程

#### 开发安全
- **代码扫描**: 自动检测硬编码密钥和敏感信息
- **依赖安全**: 检查依赖库的安全性和版本兼容性
- **发布安全**: 发布前的全面安全验证

### 用户体验改进 🎯

#### 新用户友好
- **快速开始**: 一键式环境检查和应用启动
- **详细指南**: 完整的安装、配置和使用说明
- **故障排除**: 常见问题的快速解决方案

#### 开发者体验
- **自动化工具**: 减少手动操作，提高开发效率
- **完整文档**: 覆盖开发、部署、维护全生命周期
- **标准化流程**: 统一的开发和发布规范

---

## [2.1.0] - 2025-07-15

### 新增功能 ✨

#### 1. 自定义默认想法配置
- **个性化设置**: 支持自定义默认想法、写作要求和润色要求
- **持久化存储**: 配置自动保存到 `default_ideas.json` 文件，不会上传到 GitHub
- **动态加载**: 页面刷新后自动加载用户自定义的默认值
- **便捷管理**: 在设置界面中新增"📝 默认想法配置"标签页

#### 2. Web配置界面增强
- **新增配置标签**: 在Web配置界面中添加默认想法配置标签
- **实时同步**: 配置保存后立即更新界面显示
- **刷新功能**: 支持手动刷新配置信息
- **重置功能**: 支持一键重置默认想法配置

#### 3. 动态配置加载
- **页面加载事件**: 实现页面加载时自动更新默认想法
- **配置同步**: 主界面和设置界面的配置信息实时同步
- **自动填充**: 启用自定义默认想法后，主界面自动填充配置的内容

### 技术改进 🔧

#### 代码质量
- **新增模块**: 添加 `default_ideas_manager.py` 专门管理默认想法配置
- **类型安全**: 使用 `dataclass` 确保配置数据的类型安全
- **错误处理**: 增强的异常处理和错误提示

#### 配置管理
- **文件安全**: 确保用户配置文件不会被git跟踪
- **自动创建**: 首次运行时自动创建配置文件
- **配置验证**: 自动验证配置文件的有效性

### 修复的问题 🐛

#### 1. 页面刷新问题
- **问题**: 页面刷新后自定义想法不显示在主界面中
- **修复**: 实现页面加载事件，动态更新默认想法文本框
- **技术**: 使用 `demo.load()` 事件和 `get_current_default_values()` 函数

#### 2. 设置界面同步问题
- **问题**: 设置页面打开时不自动显示已保存的配置
- **修复**: 实现配置界面的自动刷新机制
- **技术**: 修改保存/重置方法返回更新后的界面状态

#### 3. 类型兼容性问题
- **问题**: 启动时 `TypeError: can only concatenate list (not "tuple") to list`
- **修复**: 统一返回值类型，确保类型兼容性
- **技术**: 在 `app.py:669` 中添加类型转换 `list(default_ideas_info)`

### 文档更新 📚
- **README.md**: 更新版本信息和新功能说明
- **版本号**: 更新到 v2.1.0
- **功能描述**: 添加自定义默认想法配置的详细说明

### 安全性增强 🔒
- **配置文件忽略**: 更新 `.gitignore` 确保敏感配置文件不会被上传
- **用户隐私**: 用户自定义的想法和配置只保存在本地

---

## [2.0.0] - 2025-07-04

### 重大更新 🚀
- **完全重构**: 基于原项目进行全面重构和增强
- **AI 开发**: 所有代码由 Claude Code 人工智能助手生成

### 新增功能

#### 1. 统一配置管理系统
- **动态配置管理**: 新增运行时配置更新功能
- **Web 配置界面**: 实现可视化配置管理界面
- **配置验证**: 自动验证 API 密钥的有效性
- **配置文件管理**: 支持配置文件的自动创建和更新

#### 2. 增强的 AI 提供商支持
- **DeepSeek**: 新增 DeepSeek 深度求索 AI 支持
- **OpenRouter**: 新增 OpenRouter 多模型聚合平台支持
- **Claude**: 新增 Anthropic Claude AI 支持
- **Gemini**: 新增 Google Gemini 多模态 AI 支持
- **LM Studio**: 新增本地 LM Studio 模型支持
- **智谱 AI**: 新增智谱 GLM 系列模型支持
- **阿里云**: 新增阿里云通义千问系列支持

#### 3. 系统提示词优化
- **提示词合并**: 将系统提示词直接合并到 API 调用的用户消息中
- **一致性保证**: 所有 AI 提供商使用统一的提示词处理机制
- **架构简化**: 移除 wrapped_chatLLM 复杂性，代码更简洁

#### 4. 自动化生成功能
- **批量生成**: 支持自动生成指定章节数的完整小说
- **智能结尾**: 自动检测结尾阶段并生成合适的结尾
- **进度跟踪**: 实时显示生成进度和预计完成时间
- **自动保存**: 自动保存生成的小说到文件
- **中断恢复**: 支持暂停和恢复自动生成过程

#### 5. 改进的用户界面
- **现代化设计**: 基于 Gradio 的响应式用户界面
- **实时预览**: 实时显示生成过程和结果
- **错误处理**: 优雅的错误处理和用户提示
- **配置引导**: 首次使用时的配置向导

#### 6. 文件管理系统
- **自动命名**: 基于小说标题和时间戳自动命名输出文件
- **目录管理**: 自动创建和管理输出目录
- **文件格式**: 优化的文本文件格式，包含标题和章节结构

### 技术改进

#### 代码质量
- **代码重构**: 重构所有核心模块，提高可维护性
- **错误处理**: 增强的异常处理机制
- **类型安全**: 改进的类型注解和参数验证
- **代码清理**: 移除未使用的导入和变量

#### 性能优化
- **流式处理**: 优化流式 API 调用处理
- **内存管理**: 改进的记忆管理和上下文压缩
- **并发处理**: 优化多线程处理逻辑

#### 架构优化
- **模块化设计**: 更清晰的模块分离和依赖关系
- **配置抽象**: 统一的配置管理抽象层
- **插件化架构**: 易于扩展的 AI 提供商插件架构

### 文档更新
- **全新 README**: 完全重写的项目文档
- **配置指南**: 详细的配置和使用指南
- **API 文档**: 完善的 API 接口文档
- **故障排除**: 常见问题和解决方案

### 修复的问题
- **系统提示词**: 修复系统提示词在某些情况下不生效的问题
- **配置同步**: 修复配置更新后不同步的问题
- **内存泄漏**: 修复长时间运行可能的内存泄漏问题
- **异常处理**: 修复多个可能导致程序崩溃的异常

### 破坏性变更
- **配置格式**: 配置文件格式有所变化，需要重新配置
- **API 接口**: 部分内部 API 接口有变更
- **文件结构**: 项目文件结构有调整

---

## [1.0.0] - 原始版本

### 基础功能
- 基于 RecurrentGPT 的循环生成机制
- 多智能体协作框架
- 基础的小说生成功能
- 简单的 Web 界面
- 基础的配置管理

---

## 项目来源

本项目基于 [cjyyx/AI_Gen_Novel](https://github.com/cjyyx/AI_Gen_Novel) 进行二次开发，感谢原作者的贡献。

## 开发声明

v2.0.0 版本完全由 Claude Code 人工智能助手开发，体现了 AI 在软件开发中的应用潜力。